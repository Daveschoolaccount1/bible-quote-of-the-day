<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Verse of the Day</title>
<style>
  body {
    font-family: 'Georgia', serif;
    text-align: center;
    background: #fffbe6;
    color: #4e342e;
    overflow: hidden;
    margin: 0;
    height: 100vh;
  }

  #verse {
    font-size: 1.8em;
    max-width: 80%;
    margin: 100px auto 20px;
    line-height: 1.5;
    position: relative;
    padding: 20px;
    border-radius: 15px;
    background: rgba(255, 255, 240, 0.8);
    box-shadow: 0 0 20px rgba(255, 215, 0, 0.4);
  }

  #reference {
    font-size: 1.2em;
    font-style: italic;
    margin-bottom: 20px;
  }

  #timestamp {
    font-size: 0.9em;
    color: #6d4c41;
    margin-bottom: 20px;
  }

  button {
    padding: 10px 20px;
    font-size: 1em;
    background: #ffeb3b;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    color: #4e342e;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    transition: background 0.3s;
  }
  button:hover {
    background: #ffe600;
  }

  /* Shimmer Effect */
  .shimmer {
    position: relative;
    color: #4e342e;
  }
  .shimmer::after {
    content: attr(data-text);
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
    color: transparent;
    background: linear-gradient(90deg, rgba(255,235,59,0) 0%, rgba(255,235,59,1) 50%, rgba(255,235,59,0) 100%);
    background-size: 200% auto;
    -webkit-background-clip: text;
    background-clip: text;
    animation: shimmerMove 2s linear infinite;
    pointer-events: none;
  }
  @keyframes shimmerMove {
    0% { background-position: 200% center; }
    100% { background-position: -200% center; }
  }

  /* Bubbles */
  .bubble {
    position: absolute;
    bottom: -50px;
    background: rgba(255, 223, 88, 0.6);
    border-radius: 50%;
    box-shadow: 0 0 8px rgba(255, 215, 0, 0.8);
    animation: floatUp linear infinite;
  }
  @keyframes floatUp {
    0% { transform: translateY(0) scale(1); opacity: 0.6; }
    50% { opacity: 1; }
    100% { transform: translateY(-120vh) scale(1.2); opacity: 0; }
  }
</style>
</head>
<body>

<div id="verse" class="shimmer" data-text="">Loading verse...</div>
<div id="reference"></div>
<div id="timestamp"></div>
<button onclick="getVerse()">Get Another Verse</button>

<audio id="choir-sound" preload="auto">
  <source src="https://actions.google.com/sounds/v1/human_voices/chorus_ahh.ogg" type="audio/ogg">
  <source src="https://actions.google.com/sounds/v1/human_voices/chorus_ahh.mp3" type="audio/mpeg">
</audio>

<script>
  // Create bubbles
  function createBubbles() {
    for (let i = 0; i < 15; i++) {
      let bubble = document.createElement('div');
      bubble.classList.add('bubble');
      let size = Math.random() * 20 + 10;
      bubble.style.width = size + 'px';
      bubble.style.height = size + 'px';
      bubble.style.left = Math.random() * 100 + '%';
      bubble.style.animationDuration = (Math.random() * 20 + 20) + 's';
      document.body.appendChild(bubble);
    }
  }
  createBubbles();

  async function getVerse() {
    const choir = document.getElementById('choir-sound');
    try {
      let res = await fetch('https://labs.bible.org/api/?passage=random&type=json&formatting=plain');
      let data = await res.json();
      let text = data[0].text.trim();
      let reference = `${data[0].bookname} ${data[0].chapter}:${data[0].verse} (NIV)`;

      let verseEl = document.getElementById('verse');
      verseEl.classList.remove('shimmer');
      void verseEl.offsetWidth; // restart shimmer animation
      verseEl.setAttribute('data-text', `"${text}"`);
      verseEl.innerText = `"${text}"`;
      verseEl.classList.add('shimmer');

      document.getElementById('reference').innerText = reference;

      // Timestamp in WIB
      let now = new Date();
      let wibTime = new Date(now.getTime() + (7 * 60 * 60 * 1000)); // WIB offset
      document.getElementById('timestamp').innerText = "Last updated: " + wibTime.toLocaleString('en-US', { timeZone: 'Asia/Jakarta' });

      // Play choir sound
      choir.currentTime = 0;
      choir.play().catch(e => console.log('Audio blocked until user interaction:', e));

    } catch (e) {
      document.getElementById('verse').innerText = "Error loading verse.";
      console.error(e);
    }
  }

  // Load initial verse after user interacts once
  document.body.addEventListener('click', function init() {
    getVerse();
    document.body.removeEventListener('click', init);
  });
</script>

</body>
</html>
