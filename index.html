<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Bible Verse of the Day (NIV)</title>
<style>
    body {
        background: #fffbea;
        color: #3a2c1a;
        font-family: 'Georgia', serif;
        text-align: center;
        margin: 0;
        padding: 0;
        height: 100vh;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
    }

    /* Verse container */
    .verse-box {
        max-width: 700px;
        padding: 20px;
        background: rgba(255, 255, 255, 0.9);
        border-radius: 15px;
        box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        transition: opacity 0.4s ease-in-out;
        min-height: 100px;
    }

    .verse-text {
        font-size: 1.5em;
        font-weight: normal;
    }

    .verse-ref {
        margin-top: 10px;
        font-style: italic;
        font-size: 1.1em;
    }

    .timestamp {
        margin-top: 8px;
        font-size: 0.9em;
        color: #5a4a2d;
    }

    button {
        margin-top: 15px;
        padding: 10px 20px;
        font-size: 1em;
        background: gold;
        color: #3a2c1a;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        transition: background 0.3s;
    }

    button:hover {
        background: #ffdd55;
    }

    /* Bubbles */
    .bubble {
        position: fixed;
        background: rgba(255, 215, 0, 0.5);
        border-radius: 50%;
        animation: floatUp linear infinite;
        pointer-events: none;
        z-index: -1;
    }

    @keyframes floatUp {
        0% { transform: translateY(100vh); opacity: 0; }
        10% { opacity: 0.4; }
        90% { opacity: 0.4; }
        100% { transform: translateY(-10vh); opacity: 0; }
    }

    /* Loading shimmer */
    .loading {
        background: linear-gradient(90deg, #fffbea 25%, #fdf5d4 50%, #fffbea 75%);
        background-size: 200% 100%;
        animation: shimmer 1.2s infinite;
        height: 1.5em;
        border-radius: 5px;
        display: inline-block;
        width: 80%;
    }

    @keyframes shimmer {
        0% { background-position: -200% 0; }
        100% { background-position: 200% 0; }
    }
</style>
</head>
<body>

<div class="verse-box" id="verseBox">
    <div class="verse-text" id="verseText"><span class="loading"></span></div>
    <div class="verse-ref" id="verseRef"></div>
    <div class="timestamp" id="timestamp"></div>
</div>
<button onclick="getVerse()">Get Another Verse</button>

<script>
    // Create bubbles
    for (let i = 0; i < 20; i++) {
        let bubble = document.createElement('div');
        let size = Math.random() * 15 + 8;
        bubble.className = 'bubble';
        bubble.style.width = size + 'px';
        bubble.style.height = size + 'px';
        bubble.style.left = Math.random() * 100 + 'vw';
        bubble.style.animationDuration = (Math.random() * 12 + 8) + 's';
        document.body.appendChild(bubble);
    }

    async function getVerse() {
        const verseText = document.getElementById('verseText');
        const verseRef = document.getElementById('verseRef');
        const timestamp = document.getElementById('timestamp');
        
        // Show loading shimmer
        verseText.innerHTML = '<span class="loading"></span>';
        verseRef.textContent = '';
        timestamp.textContent = '';

        try {
            let res = await fetch('https://labs.bible.org/api/?passage=random&type=json');
            let data = await res.json();
            let verse = data[0];

            // Filter out genealogy / lists
            let badPatterns = /(son of|the son of|begat|cubits|from the family of|descendant of)/i;
            if (badPatterns.test(verse.text)) {
                return getVerse(); // Retry
            }

            verseText.textContent = `"${verse.text.trim()}"`;
            verseRef.textContent = `${verse.bookname} ${verse.chapter}:${verse.verse} (NIV)`;

            // Local Indonesian time
            let options = { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: true, timeZone: 'Asia/Jakarta' };
            let date = new Date().toLocaleString('en-US', options);
            timestamp.textContent = `Last updated: ${date}`;
        } catch (e) {
            verseText.textContent = "Error loading verse.";
            console.error(e);
        }
    }

    // Load verse immediately on page load
    window.onload = getVerse;
</script>

</body>
</html>
